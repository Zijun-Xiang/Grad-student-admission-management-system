import{_ as L,j as _,r as y,w as P,c as l,a as t,d as h,t as d,F as x,f as Y,n as U,k as b,o as r,l as V,h as B,i as I,u as w,m as E}from"./index-CBvISKLU.js";const O={class:"calendar"},R={class:"cal-header"},W={class:"title"},q={class:"dow"},G={class:"grid"},H={class:"num"},z={key:0,class:"legend"},J={__name:"MiniCalendar",props:{entryDate:{type:String,default:""}},setup(A){const i=A,C=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],p=o=>{if(!o)return null;const n=new Date(o+"T00:00:00");return isNaN(n.getTime())?null:n},D=new Date,k=_(()=>p(i.entryDate)),v=y(D.getFullYear()),u=y(D.getMonth());P(()=>i.entryDate,o=>{const n=p(o);n&&(v.value=n.getFullYear(),u.value=n.getMonth())},{immediate:!0});const $=_(()=>new Date(v.value,u.value,1).toLocaleString(void 0,{month:"long",year:"numeric"})),f=_(()=>{const o=k.value;if(!o)return"";const n=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),m=String(o.getDate()).padStart(2,"0");return`${n}-${c}-${m}`}),S=(o,n)=>o&&n&&o.getFullYear()===n.getFullYear()&&o.getMonth()===n.getMonth()&&o.getDate()===n.getDate(),M=_(()=>{const n=new Date(v.value,u.value,1).getDay(),c=new Date(v.value,u.value+1,0).getDate(),m=[];for(let s=0;s<n;s++)m.push({day:"",date:null});for(let s=1;s<=c;s++)m.push({day:s,date:new Date(v.value,u.value,s)});for(;m.length%7!==0;)m.push({day:"",date:null});return m}),T=o=>o.date?{today:S(o.date,D),entry:S(o.date,k.value)}:"empty",N=()=>{u.value===0?(u.value=11,v.value-=1):u.value-=1},F=()=>{u.value===11?(u.value=0,v.value+=1):u.value+=1};return(o,n)=>(r(),l("div",O,[t("div",R,[t("button",{class:"nav",onClick:N},"<"),t("div",W,d($.value),1),t("button",{class:"nav",onClick:F},">")]),t("div",q,[(r(),l(x,null,Y(C,c=>t("div",{key:c,class:"dow-cell"},d(c),1)),64))]),t("div",G,[(r(!0),l(x,null,Y(M.value,(c,m)=>(r(),l("div",{key:m,class:U(["cell",T(c)])},[t("span",H,d(c.day),1)],2))),128))]),f.value?(r(),l("div",z,[n[0]||(n[0]=t("span",{class:"dot entry"},null,-1)),b(" Entry: "+d(f.value)+" ",1),n[1]||(n[1]=t("span",{class:"dot today"},null,-1)),n[2]||(n[2]=b(" Today ",-1))])):h("",!0)]))}},K=L(J,[["__scopeId","data-v-4223aacf"]]),Q={class:"dashboard-layout"},X={class:"navbar"},Z={class:"user-info"},tt={key:0},et={class:"main-container"},st={class:"sidebar"},nt={class:"content"},ot={class:"card"},at={key:0,class:"loading-text"},lt={key:1,class:"status-grid"},rt={class:"left-panel"},ut={class:"status-item"},dt={key:0,class:"text-muted"},it={class:"text-muted"},ct={class:"status-item"},mt={key:0,class:"status-bad"},vt={key:1,class:"status-good"},yt={key:2,class:"hold-list"},_t={class:"status-item deficiency-section"},pt={key:0,class:"text-muted"},gt={key:1,class:"deficiency-list"},ht={class:"course-code"},ft={class:"course-name"},Dt={class:"course-badge"},kt={class:"status-item upload-section"},St={class:"doc-status"},wt={class:"doc-row"},bt={class:"doc-right"},Ct={key:0,class:"doc-comment"},Tt={class:"doc-row"},$t={class:"doc-right"},Mt={key:1,class:"doc-comment"},Nt={__name:"DashboardView",setup(A){const i=B(),C=y({}),p=y([]),D=y([]),k=y([]),v=y(null),u=y(null),$=y(!0),f=s=>D.value.find(e=>e.doc_type===s)||null,S=_(()=>{var s;return((s=f("admission_letter"))==null?void 0:s.status)||"none"}),M=_(()=>{var s;return((s=f("admission_letter"))==null?void 0:s.admin_comment)||""}),T=_(()=>{var s;return((s=f("major_professor_form"))==null?void 0:s.status)||"none"}),N=_(()=>{var s;return((s=f("major_professor_form"))==null?void 0:s.admin_comment)||""}),F=s=>{const e=new Date(s+"T00:00:00");if(isNaN(e.getTime()))return"Unknown";const a=e.getFullYear(),g=e.getMonth()+1;return g<=4?`${a}SP`:g<=8?`${a}SU`:`${a}FA`},o=s=>{const e=String(s).match(/^(\d{4})(SP|SU|FA)$/);if(!e)return 0;const a=Number(e[1]),g=e[2],j=g==="SP"?0:g==="SU"?1:2;return a*3+j},n=_(()=>{if(u.value)return{entryDate:u.value.entry_date||"",entryTerm:u.value.entry_term_code||"Unknown",currentTerm:u.value.current_term_code||"Unknown",termNumber:Number(u.value.term_number||1)};const s=v.value||{},e=s.entry_date||"",a=s.entry_term_code||(e?F(e):""),g=F(new Date().toISOString().slice(0,10)),j=a?Math.max(1,o(g)-o(a)+1):1;return{entryDate:e,entryTerm:a||"Unknown",currentTerm:g,termNumber:j}});V(()=>{const s=localStorage.getItem("user");s?(C.value=JSON.parse(s),c()):i.push("/")});const c=async()=>{try{const s=await I.get("get_status.php");s.data.status==="success"&&(p.value=s.data.holds,D.value=s.data.documents,k.value=s.data.deficiencies||[],v.value=s.data.profile||null,u.value=s.data.term||null)}catch(s){console.error(s)}finally{$.value=!1}},m=async()=>{try{await I.post("logout.php")}catch{}localStorage.removeItem("user"),i.push("/")};return(s,e)=>(r(),l("div",Q,[t("header",X,[e[6]||(e[6]=t("div",{class:"brand"},"Grad System",-1)),t("div",Z,[C.value.username?(r(),l("span",tt,"Welcome, "+d(C.value.username),1)):h("",!0),t("button",{onClick:m,class:"btn-logout"},"Logout")])]),t("div",et,[t("aside",st,[t("nav",null,[t("ul",null,[e[7]||(e[7]=t("li",{class:"active"},"Dashboard",-1)),t("li",{onClick:e[0]||(e[0]=a=>w(i).push("/my-courses"))},"My Courses"),t("li",{onClick:e[1]||(e[1]=a=>w(i).push("/documents"))},"Documents"),t("li",{onClick:e[2]||(e[2]=a=>w(i).push("/assignments"))},"Assignments"),n.value.termNumber>=2?(r(),l("li",{key:0,onClick:e[3]||(e[3]=a=>w(i).push("/major-professor"))},"Major Professor")):h("",!0),n.value.termNumber>=3?(r(),l("li",{key:1,onClick:e[4]||(e[4]=a=>w(i).push("/thesis-project"))},"Thesis / Project")):h("",!0)])])]),t("main",nt,[t("div",ot,[e[19]||(e[19]=t("h2",null,"Student Status",-1)),$.value?(r(),l("div",at,"Loading status...")):(r(),l("div",lt,[t("div",rt,[t("div",ut,[e[12]||(e[12]=t("h3",null,"Academic Calendar",-1)),n.value.entryDate?(r(),l("div",dt,[e[8]||(e[8]=b(" Entry Date: ",-1)),t("strong",null,d(n.value.entryDate),1),e[9]||(e[9]=b(" · Entry Term: ",-1)),t("strong",null,d(n.value.entryTerm),1)])):h("",!0),t("div",it,[e[10]||(e[10]=b(" Current Term: ",-1)),t("strong",null,d(n.value.currentTerm),1),e[11]||(e[11]=b(" · You are in ",-1)),t("strong",null,"Term "+d(n.value.termNumber),1)]),E(K,{"entry-date":n.value.entryDate},null,8,["entry-date"])]),t("div",ct,[e[13]||(e[13]=t("h3",null,"Current Holds",-1)),p.value.length>0?(r(),l("div",mt,"You have "+d(p.value.length)+" active hold(s).",1)):(r(),l("div",vt,"No Holds. You are good to register.")),p.value.length>0?(r(),l("ul",yt,[(r(!0),l(x,null,Y(p.value,a=>(r(),l("li",{key:a.id},d(a.hold_type)+" (Active)",1))),128))])):h("",!0)]),t("div",_t,[e[14]||(e[14]=t("h3",null,"Deficiency Courses",-1)),k.value.length===0?(r(),l("div",pt,"No deficiency courses assigned.")):(r(),l("ul",gt,[(r(!0),l(x,null,Y(k.value,a=>(r(),l("li",{key:a.course_code},[t("span",ht,d(a.course_code),1),t("span",ft,d(a.course_name),1),t("span",Dt,d(a.status),1)]))),128))]))])]),t("div",kt,[e[17]||(e[17]=t("h3",null,"Documents Status",-1)),t("div",St,[t("div",wt,[e[15]||(e[15]=t("div",{class:"doc-left"},[t("div",{class:"doc-title"},"Admission Letter"),t("div",{class:"doc-sub"},"Required for Term 1 hold release")],-1)),t("div",bt,[t("span",{class:U(["badge",S.value])},d(S.value),3)])]),S.value==="rejected"&&M.value?(r(),l("div",Ct," Admin comment: "+d(M.value),1)):h("",!0),t("div",Tt,[e[16]||(e[16]=t("div",{class:"doc-left"},[t("div",{class:"doc-title"},"Major Professor Form"),t("div",{class:"doc-sub"},"Required for Term 2 hold release")],-1)),t("div",$t,[t("span",{class:U(["badge",T.value])},d(T.value),3)])]),T.value==="rejected"&&N.value?(r(),l("div",Mt," Admin comment: "+d(N.value),1)):h("",!0)]),t("button",{class:"btn-primary",onClick:e[5]||(e[5]=a=>w(i).push("/documents"))},"Go to Documents"),e[18]||(e[18]=t("p",{class:"text-muted",style:{"margin-top":"10px"}}," Uploads are handled in Documents. Dashboard only shows status. ",-1))])]))])])])]))}},xt=L(Nt,[["__scopeId","data-v-126c3831"]]);export{xt as default};
