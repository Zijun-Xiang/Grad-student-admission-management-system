import{_ as E,r as o,w as Y,c as f,a as t,b as O,d as T,e as r,v as k,F as B,f as q,g as n,t as C,u as A,h as I,o as g,i as L}from"./index-DT2F-dT6.js";const _={class:"login-container"},j={class:"login-card"},G={class:"form-group"},H={class:"form-row"},J={class:"form-group"},z=["value"],K={class:"form-group"},Q={key:0,class:"form-row"},W={class:"form-group"},X={class:"form-group"},Z={class:"form-group"},h={class:"form-group"},ee={class:"form-group"},te={class:"form-group"},le={class:"form-group"},se={key:1,class:"error-msg"},ae=["disabled"],oe={__name:"RegisterView",setup(re){const R=I(),y=o("student"),c=o(""),D=o(""),i=o(""),a=o(""),v=o(new Date().getFullYear()),V=o([]),S=o(""),U=o(""),w=o(""),F=o(""),d=o(""),b=o(!1),N=s=>{const e=new Date(s+"T00:00:00");if(isNaN(e.getTime()))return"";const l=e.getFullYear(),p=e.getMonth()+1;return p<=4?`${l}SP`:p<=8?`${l}SU`:`${l}FA`};(()=>{const s=new Date().getFullYear();V.value=[];for(let e=s-5;e<=s+5;e++)V.value.push(e)})();const x=()=>new Date().toISOString().slice(0,10);a.value=x(),i.value=N(a.value);const M=()=>{if(!a.value)return;const s=a.value.split("-");s.length===3&&(a.value=`${v.value}-${s[1]}-${s[2]}`,i.value=N(a.value))},P=()=>{if(!a.value)return;const s=new Date(a.value+"T00:00:00");isNaN(s.getTime())||(v.value=s.getFullYear(),i.value=N(a.value))};Y(v,M),Y(a,P);const $=async()=>{var s,e,l,p;if(d.value="",w.value!==F.value){d.value="Passwords do not match.";return}b.value=!0;try{const m={role:y.value,username:S.value,email:U.value,password:w.value,first_name:c.value,last_name:D.value,term_code:i.value,entry_date:a.value},u=await L.post("register.php",m);((s=u.data)==null?void 0:s.status)==="success"?(localStorage.setItem("user",JSON.stringify(u.data.user)),R.push(u.data.user.role==="faculty"?"/faculty":u.data.user.role==="admin"?"/admin":"/dashboard")):d.value=((e=u.data)==null?void 0:e.message)||"Registration failed."}catch(m){const u=(p=(l=m==null?void 0:m.response)==null?void 0:l.data)==null?void 0:p.message;d.value=u||"Registration failed (network/CORS/DB)."}finally{b.value=!1}};return(s,e)=>(g(),f("div",_,[t("div",j,[e[23]||(e[23]=t("div",{class:"login-header"},[t("h1",null,"Create Account"),t("p",null,"Register as Student or Faculty")],-1)),t("form",{onSubmit:O($,["prevent"])},[t("div",G,[e[12]||(e[12]=t("label",null,"Role",-1)),r(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),required:""},[...e[11]||(e[11]=[t("option",{value:"student"},"Student",-1),t("option",{value:"faculty"},"Faculty (GPD/Major Professor)",-1)])],512),[[k,y.value]])]),t("div",H,[t("div",J,[e[13]||(e[13]=t("label",null,"Entry Year",-1)),r(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>v.value=l)},[(g(!0),f(B,null,q(V.value,l=>(g(),f("option",{key:l,value:l},C(l),9,z))),128))],512),[[k,v.value]])]),t("div",K,[e[14]||(e[14]=t("label",null,"Entry Date",-1)),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.value=l),type:"date"},null,512),[[n,a.value]])])]),y.value==="student"?(g(),f("div",Q,[t("div",W,[e[15]||(e[15]=t("label",null,"First Name",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>c.value=l),type:"text",placeholder:"First name"},null,512),[[n,c.value]])]),t("div",X,[e[16]||(e[16]=t("label",null,"Last Name",-1)),r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>D.value=l),type:"text",placeholder:"Last name"},null,512),[[n,D.value]])])])):T("",!0),t("div",Z,[e[17]||(e[17]=t("label",null,"Entry Term Code (auto)",-1)),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>i.value=l),type:"text",disabled:""},null,512),[[n,i.value]]),e[18]||(e[18]=t("div",{class:"hint"},"Derived from Entry Date. Used to tag your first-semester Hold.",-1))]),t("div",h,[e[19]||(e[19]=t("label",null,"Username",-1)),r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>S.value=l),type:"text",placeholder:"e.g. student1 / prof_jamil",required:""},null,512),[[n,S.value]])]),t("div",ee,[e[20]||(e[20]=t("label",null,"Email",-1)),r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>U.value=l),type:"email",placeholder:"Optional"},null,512),[[n,U.value]])]),t("div",te,[e[21]||(e[21]=t("label",null,"Password",-1)),r(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>w.value=l),type:"password",placeholder:"At least 6 characters",required:""},null,512),[[n,w.value]])]),t("div",le,[e[22]||(e[22]=t("label",null,"Confirm Password",-1)),r(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>F.value=l),type:"password",placeholder:"Re-enter password",required:""},null,512),[[n,F.value]])]),d.value?(g(),f("div",se,C(d.value),1)):T("",!0),t("button",{type:"submit",class:"btn-primary",disabled:b.value},C(b.value?"Creating...":"Create account"),9,ae),t("button",{type:"button",class:"btn-secondary",onClick:e[10]||(e[10]=l=>A(R).push("/"))},"Back to login")],32)])]))}},ie=E(oe,[["__scopeId","data-v-da0e179d"]]);export{ie as default};
