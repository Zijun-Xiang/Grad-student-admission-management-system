import{_ as L,j as v,r as p,w as U,c as l,a as e,d as k,t as d,F as x,f as N,n as j,k as S,o as r,l as V,h as P,i as A,u as F,m as B}from"./index-DT2F-dT6.js";const E={class:"calendar"},O={class:"cal-header"},R={class:"title"},W={class:"dow"},q={class:"grid"},G={class:"num"},H={key:0,class:"legend"},z={__name:"MiniCalendar",props:{entryDate:{type:String,default:""}},setup(I){const m=I,w=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],y=o=>{if(!o)return null;const n=new Date(o+"T00:00:00");return isNaN(n.getTime())?null:n},g=new Date,h=v(()=>y(m.entryDate)),c=p(g.getFullYear()),u=p(g.getMonth());U(()=>m.entryDate,o=>{const n=y(o);n&&(c.value=n.getFullYear(),u.value=n.getMonth())},{immediate:!0});const f=v(()=>new Date(c.value,u.value,1).toLocaleString(void 0,{month:"long",year:"numeric"})),D=v(()=>{const o=h.value;if(!o)return"";const n=o.getFullYear(),i=String(o.getMonth()+1).padStart(2,"0"),s=String(o.getDate()).padStart(2,"0");return`${n}-${i}-${s}`}),b=(o,n)=>o&&n&&o.getFullYear()===n.getFullYear()&&o.getMonth()===n.getMonth()&&o.getDate()===n.getDate(),C=v(()=>{const n=new Date(c.value,u.value,1).getDay(),i=new Date(c.value,u.value+1,0).getDate(),s=[];for(let t=0;t<n;t++)s.push({day:"",date:null});for(let t=1;t<=i;t++)s.push({day:t,date:new Date(c.value,u.value,t)});for(;s.length%7!==0;)s.push({day:"",date:null});return s}),M=o=>o.date?{today:b(o.date,g),entry:b(o.date,h.value)}:"empty",T=()=>{u.value===0?(u.value=11,c.value-=1):u.value-=1},$=()=>{u.value===11?(u.value=0,c.value+=1):u.value+=1};return(o,n)=>(r(),l("div",E,[e("div",O,[e("button",{class:"nav",onClick:T},"<"),e("div",R,d(f.value),1),e("button",{class:"nav",onClick:$},">")]),e("div",W,[(r(),l(x,null,N(w,i=>e("div",{key:i,class:"dow-cell"},d(i),1)),64))]),e("div",q,[(r(!0),l(x,null,N(C.value,(i,s)=>(r(),l("div",{key:s,class:j(["cell",M(i)])},[e("span",G,d(i.day),1)],2))),128))]),D.value?(r(),l("div",H,[n[0]||(n[0]=e("span",{class:"dot entry"},null,-1)),S(" Entry: "+d(D.value)+" ",1),n[1]||(n[1]=e("span",{class:"dot today"},null,-1)),n[2]||(n[2]=S(" Today ",-1))])):k("",!0)]))}},J=L(z,[["__scopeId","data-v-4223aacf"]]),K={class:"dashboard-layout"},Q={class:"navbar"},X={class:"user-info"},Z={key:0},tt={class:"main-container"},et={class:"sidebar"},st={class:"content"},ot={class:"card"},nt={key:0,class:"loading-text"},at={key:1,class:"status-grid"},lt={class:"left-panel"},rt={class:"status-item"},dt={key:0,class:"text-muted"},ut={class:"text-muted"},it={class:"status-item"},ct={key:0,class:"status-bad"},mt={key:1,class:"status-good"},vt={key:2,class:"hold-list"},yt={class:"status-item deficiency-section"},_t={key:0,class:"text-muted"},pt={key:1,class:"deficiency-list"},gt={class:"course-code"},ht={class:"course-name"},ft={class:"course-badge"},Dt={class:"status-item upload-section"},kt={class:"doc-status"},St={class:"doc-row"},wt={class:"doc-right"},bt={key:0,class:"doc-comment"},Ct={class:"doc-row"},Mt={class:"doc-right"},Tt={key:1,class:"doc-comment"},$t={__name:"DashboardView",setup(I){const m=P(),w=p({}),y=p([]),g=p([]),h=p([]),c=p(null),u=p(!0),f=s=>g.value.find(t=>t.doc_type===s)||null,D=v(()=>{var s;return((s=f("admission_letter"))==null?void 0:s.status)||"none"}),b=v(()=>{var s;return((s=f("admission_letter"))==null?void 0:s.admin_comment)||""}),C=v(()=>{var s;return((s=f("major_professor_form"))==null?void 0:s.status)||"none"}),M=v(()=>{var s;return((s=f("major_professor_form"))==null?void 0:s.admin_comment)||""}),T=s=>{const t=new Date(s+"T00:00:00");if(isNaN(t.getTime()))return"Unknown";const a=t.getFullYear(),_=t.getMonth()+1;return _<=4?`${a}SP`:_<=8?`${a}SU`:`${a}FA`},$=s=>{const t=String(s).match(/^(\d{4})(SP|SU|FA)$/);if(!t)return 0;const a=Number(t[1]),_=t[2],Y=_==="SP"?0:_==="SU"?1:2;return a*3+Y},o=v(()=>{const s=c.value||{},t=s.entry_date||"",a=s.entry_term_code||(t?T(t):""),_=T(new Date().toISOString().slice(0,10)),Y=a?Math.max(1,$(_)-$(a)+1):1;return{entryDate:t,entryTerm:a||"Unknown",currentTerm:_,termNumber:Y}});V(()=>{const s=localStorage.getItem("user");s?(w.value=JSON.parse(s),n()):m.push("/")});const n=async()=>{try{const s=await A.get("get_status.php");s.data.status==="success"&&(y.value=s.data.holds,g.value=s.data.documents,h.value=s.data.deficiencies||[],c.value=s.data.profile||null)}catch(s){console.error(s)}finally{u.value=!1}},i=async()=>{try{await A.post("logout.php")}catch{}localStorage.removeItem("user"),m.push("/")};return(s,t)=>(r(),l("div",K,[e("header",Q,[t[4]||(t[4]=e("div",{class:"brand"},"Grad System",-1)),e("div",X,[w.value.username?(r(),l("span",Z,"Welcome, "+d(w.value.username),1)):k("",!0),e("button",{onClick:i,class:"btn-logout"},"Logout")])]),e("div",tt,[e("aside",et,[e("nav",null,[e("ul",null,[t[5]||(t[5]=e("li",{class:"active"},"Dashboard",-1)),e("li",{onClick:t[0]||(t[0]=a=>F(m).push("/my-courses"))},"My Courses"),e("li",{onClick:t[1]||(t[1]=a=>F(m).push("/documents"))},"Documents"),e("li",{onClick:t[2]||(t[2]=a=>F(m).push("/major-professor"))},"Major Professor")])])]),e("main",st,[e("div",ot,[t[17]||(t[17]=e("h2",null,"Student Status",-1)),u.value?(r(),l("div",nt,"Loading status...")):(r(),l("div",at,[e("div",lt,[e("div",rt,[t[10]||(t[10]=e("h3",null,"Academic Calendar",-1)),o.value.entryDate?(r(),l("div",dt,[t[6]||(t[6]=S(" Entry Date: ",-1)),e("strong",null,d(o.value.entryDate),1),t[7]||(t[7]=S(" · Entry Term: ",-1)),e("strong",null,d(o.value.entryTerm),1)])):k("",!0),e("div",ut,[t[8]||(t[8]=S(" Current Term: ",-1)),e("strong",null,d(o.value.currentTerm),1),t[9]||(t[9]=S(" · You are in ",-1)),e("strong",null,"Term "+d(o.value.termNumber),1)]),B(J,{"entry-date":o.value.entryDate},null,8,["entry-date"])]),e("div",it,[t[11]||(t[11]=e("h3",null,"Current Holds",-1)),y.value.length>0?(r(),l("div",ct,"You have "+d(y.value.length)+" active hold(s).",1)):(r(),l("div",mt,"No Holds. You are good to register.")),y.value.length>0?(r(),l("ul",vt,[(r(!0),l(x,null,N(y.value,a=>(r(),l("li",{key:a.id},d(a.hold_type)+" (Active)",1))),128))])):k("",!0)]),e("div",yt,[t[12]||(t[12]=e("h3",null,"Deficiency Courses",-1)),h.value.length===0?(r(),l("div",_t,"No deficiency courses assigned.")):(r(),l("ul",pt,[(r(!0),l(x,null,N(h.value,a=>(r(),l("li",{key:a.course_code},[e("span",gt,d(a.course_code),1),e("span",ht,d(a.course_name),1),e("span",ft,d(a.status),1)]))),128))]))])]),e("div",Dt,[t[15]||(t[15]=e("h3",null,"Documents Status",-1)),e("div",kt,[e("div",St,[t[13]||(t[13]=e("div",{class:"doc-left"},[e("div",{class:"doc-title"},"Admission Letter"),e("div",{class:"doc-sub"},"Required for Term 1 hold release")],-1)),e("div",wt,[e("span",{class:j(["badge",D.value])},d(D.value),3)])]),D.value==="rejected"&&b.value?(r(),l("div",bt," Admin comment: "+d(b.value),1)):k("",!0),e("div",Ct,[t[14]||(t[14]=e("div",{class:"doc-left"},[e("div",{class:"doc-title"},"Major Professor Form"),e("div",{class:"doc-sub"},"Required for Term 2 hold release")],-1)),e("div",Mt,[e("span",{class:j(["badge",C.value])},d(C.value),3)])]),C.value==="rejected"&&M.value?(r(),l("div",Tt," Admin comment: "+d(M.value),1)):k("",!0)]),e("button",{class:"btn-primary",onClick:t[3]||(t[3]=a=>F(m).push("/documents"))},"Go to Documents"),t[16]||(t[16]=e("p",{class:"text-muted",style:{"margin-top":"10px"}}," Uploads are handled in Documents. Dashboard only shows status. ",-1))])]))])])])]))}},xt=L($t,[["__scopeId","data-v-76b81e1a"]]);export{xt as default};
