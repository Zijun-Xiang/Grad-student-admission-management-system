import{_ as St,r as u,l as At,h as $t,i as p,j as re,c as l,a as s,d as _,t as i,n as A,k as w,F as h,f as b,e as f,v as M,g as $,o,p as Tt}from"./index-CBvISKLU.js";const Dt={class:"dashboard-layout"},Lt={class:"navbar"},xt={class:"user-info"},Rt={key:0},Ut={class:"main-container"},Mt={class:"sidebar"},Ft={class:"content"},Nt={key:0,class:"card mb-30"},Pt={key:0,class:"loading-text"},Vt={key:1,class:"empty-state"},Et={key:2,class:"review-list"},jt={class:"info"},Ot={class:"student-name"},qt={class:"file-link"},Ht={key:0,class:"file-link"},Bt={key:0,class:"muted"},It={class:"actions"},Wt=["href"],Gt=["onClick","disabled"],Jt={key:1,class:"stack"},Yt={class:"card mb-30"},zt={key:0,class:"msg bad"},Qt={class:"form-row"},Zt=["value"],Kt=["disabled"],Xt={key:2,class:"empty-state"},es={key:3,class:"table mt-20"},ts={class:"actions"},ss=["onClick","disabled"],as={class:"card"},ls={class:"form-row",style:{margin:"10px 0 6px"}},os=["disabled"],ns={key:0,class:"empty-state"},is={key:1,class:"table mt-20"},ds={class:"muted"},us={key:2,class:"stack"},rs={class:"card mb-30"},cs={class:"form-grid"},vs={class:"form-group"},_s={class:"form-group"},ms={class:"form-group full"},ps={class:"form-group"},gs=["disabled"],fs={key:0,class:"form-group"},ys={key:0,class:"msg bad",style:{margin:"0 0 10px"}},hs=["disabled"],bs=["value"],ks={key:1,class:"form-group full"},ws=["value"],Cs={class:"form-group full"},Ss={class:"form-actions"},As=["disabled"],$s={class:"card mb-30"},Ts={key:0,class:"loading-text"},Ds={key:1,class:"empty-state"},Ls={key:2,class:"review-list"},xs={class:"info"},Rs={class:"student-name"},Us={class:"file-link"},Ms={key:0},Fs={class:"file-link"},Ns={class:"actions"},Ps=["onClick"],Vs=["onClick"],Es=["onClick"],js=["onClick"],Os={key:0,class:"card"},qs={key:0,class:"msg bad"},Hs={key:1,class:"loading-text"},Bs={key:2,class:"review-list"},Is={class:"info"},Ws={class:"student-name"},Gs={class:"file-link"},Js={key:0},Ys={key:0,class:"file-link"},zs={key:0},Qs={key:1,class:"muted"},Zs={key:2,class:"muted"},Ks={class:"actions"},Xs=["onClick"],ea=["onClick"],ta={key:2,class:"grade-box"},sa=["value","onInput","disabled"],aa=["onClick","disabled"],la=["onClick","disabled"],oa={key:3,class:"card mb-30"},na={class:"form-row",style:{margin:"10px 0 6px"}},ia=["value"],da=["disabled"],ua={key:0,class:"empty-state"},ra={key:1,class:"review-list"},ca={class:"info"},va={class:"student-name"},_a={key:0,class:"muted"},ma={class:"doc-meta-row"},pa={class:"doc-source-pill"},ga={class:"doc-format-pill"},fa={key:0,class:"muted"},ya={class:"actions"},ha=["href"],ba=["onClick"],ka={key:4,class:"stack"},wa={class:"card mb-30"},Ca={key:0,class:"loading-text"},Sa={key:1,class:"empty-state"},Aa={key:2,class:"table"},$a={class:"card"},Ta={class:"form-row",style:{margin:"10px 0 6px"}},Da=["disabled"],La={key:0,class:"loading-text"},xa={key:1,class:"empty-state"},Ra={key:2,class:"table mt-20"},Ua={class:"muted"},Ma={key:0,class:"actions"},Fa=["href"],Na=["onClick"],Pa={key:1,class:"muted"},Va={key:5,class:"card"},Ea={key:0,class:"empty-state"},ja={key:1,class:"review-list"},Oa={class:"info"},qa={class:"student-name"},Ha={class:"email-text"},Ba={class:"actions"},Ia=["onClick"],Wa=["onClick"],Ga={key:0,class:"modal-overlay"},Ja={class:"modal-box wide-modal"},Ya={key:0,class:"comment-meta"},za={class:"comment-list"},Qa={key:0,class:"loading-text"},Za={key:1,class:"empty-state"},Ka={key:2},Xa={class:"comment-head"},el={class:"comment-author"},tl={class:"comment-time"},sl={class:"comment-body"},al={class:"modal-actions"},ll=["disabled"],ol={key:1,class:"modal-overlay"},nl={class:"modal-box wide-modal"},il={key:0,class:"comment-meta"},dl={class:"comment-list"},ul={key:0,class:"loading-text"},rl={key:1,class:"empty-state"},cl={key:2},vl={class:"comment-head"},_l={class:"comment-author"},ml={class:"comment-time"},pl={class:"comment-body"},gl={class:"modal-actions"},fl=["disabled"],yl={key:2,class:"modal-overlay"},hl={class:"modal-box wide-modal"},bl={key:1,class:"form-grid"},kl={class:"form-group full"},wl={class:"form-group full"},Cl={class:"form-group"},Sl={class:"form-group"},Al=["disabled"],$l={key:0,class:"form-group"},Tl=["value"],Dl={key:1,class:"form-group"},Ll=["disabled"],xl=["value"],Rl={key:2,class:"form-group full"},Ul=["value"],Ml={class:"modal-actions"},Fl=["disabled"],Nl=["disabled"],Pl={__name:"FacultyDashboardView",setup(Vl){const ce=$t(),K=u({}),y=u("research"),ve=u([]),_e=u([]),me=u(!0),pe=u([]),X=u(""),ge=u([]),E=u(!0),F=u([]),m=u({title:"",description:"",due_at:"",target_mode:"all",course_code:""}),B=u([]),ee=u(null),te=u(!1),x=u(""),R=u(!0),fe=u(!1),se=u([]),T=u(null),ye=u(!1),I=u([]),j=u({}),O=u(""),N=u(""),q=u(!0),W=u(""),he=u(!1),c=u(null),G=u(!1),C=u(""),S=u(!0),be=u(!1),D=u(null),J=u([]),ke=u(!1),P=u(""),ae=u(!1),we=u(!0),Ce=u([]),Se=u([]),Ae=u(""),Ne=u([]),H=u(""),U=u(!1),Y=u(""),z=u(!0),$e=u(!1),Te=u([]),le=u(!1),Pe=u([]),De=u(""),Le=u(""),xe=u(""),Re=u(!1),L=u(null),Q=u([]),Ue=u(!1),V=u(""),oe=u(!1);At(()=>{const a=localStorage.getItem("user");if(a){if(K.value=JSON.parse(a),K.value.role!=="faculty")return ce.push("/dashboard");Ee(),je(),Oe(),ot(),de(),ne(),nt(),qe()}else ce.push("/")});const Me=a=>`${Tt}/download_document.php?doc_id=${a.doc_id}`,Ze=a=>{const e=String(a||"").trim();return e?{thesis_project:"THESIS / PROJECT",major_professor_form:"MAJOR PROFESSOR FORM",admission_letter:"ADMISSION LETTER",research_method_proof:"RESEARCH METHOD"}[e]||e.replace(/_/g," ").toUpperCase():"DOCUMENT"},Ke=a=>{var n;const e=String(a||"").trim(),t=e.includes(".")?(n=e.split(".").pop())==null?void 0:n.toLowerCase():"";return t?{pdf:"PDF",doc:"WORD",docx:"WORD",jpg:"JPG",jpeg:"JPG",png:"PNG"}[t]||t.toUpperCase():"-"},Xe=a=>{const e=String(a||"").trim().toLowerCase();return e||"-"},et=a=>{const e=String(a||"").trim().toLowerCase();return e==="approved"?"st-approved":e==="pending"?"st-pending":e==="rejected"?"st-rejected":"st-other"},Ve=a=>{const e=URL.createObjectURL(a);window.open(e,"_blank","noopener,noreferrer"),setTimeout(()=>URL.revokeObjectURL(e),6e4)},Ee=async()=>{try{const a=await p.get("faculty_get_mp_requests.php");a.data.status==="success"&&(ve.value=a.data.data)}catch(a){console.error(a)}},je=async()=>{try{const a=await p.get("faculty_get_advisee_documents.php");a.data.status==="success"&&(_e.value=a.data.data||[])}catch(a){console.error(a)}},Oe=async()=>{var a;me.value=!0;try{const e=await p.get("faculty_get_research_method_holds.php");((a=e.data)==null?void 0:a.status)==="success"&&(pe.value=e.data.data||[])}catch(e){console.error(e)}finally{me.value=!1}},tt=async()=>{var a;$e.value=!0;try{const e=await p.get("defense_windows_list.php");((a=e.data)==null?void 0:a.status)==="success"&&(Te.value=e.data.data||[])}catch(e){console.error(e)}finally{$e.value=!1}},qe=async()=>{var a;le.value=!0;try{await tt();const e=await p.get("faculty_get_thesis_projects.php");((a=e.data)==null?void 0:a.status)==="success"&&(Pe.value=e.data.data||[])}catch(e){console.error(e)}finally{le.value=!1}},He=re(()=>{const a=(De.value||"").trim().toLowerCase(),e=Pe.value||[];return a?e.filter(t=>[t.student_id,t.student_username,t.student_email,t.first_name,t.last_name,t.title,t.type,t.submission_date,t.defense_date].map(n=>String(n||"").toLowerCase()).join(" ").includes(a)):e}),st=re(()=>{const a=(_e.value||[]).map(e=>String(e.entry_term_code||"").trim()).filter(e=>e!=="");return Array.from(new Set(a)).sort((e,t)=>t.localeCompare(e))}),Be=re(()=>{const a=(Le.value||"").trim().toLowerCase(),e=(xe.value||"").trim().toUpperCase();return(_e.value||[]).filter(d=>e&&String(d.entry_term_code||"").toUpperCase()!==e?!1:a?[d.student_id,d.student_username,d.student_email,d.first_name,d.last_name,d.entry_term_code,d.doc_type,d.status,d.file_path].map(r=>String(r||"").toLowerCase()).join(" ").includes(a):!0)}),at=async a=>{a!=null&&a.thesis_doc_id&&await Fe({doc_id:a.thesis_doc_id,student_id:a.student_id,student_username:a.student_username,doc_type:"thesis_project",file_path:a.thesis_file_path,status:a.thesis_doc_status})},lt=async a=>{var e,t,d,n;X.value=String(a.student_id);try{const r=await p.post("faculty_lift_research_method_hold.php",{student_id:a.student_id});((e=r.data)==null?void 0:e.status)==="success"?(alert(`Hold lifted. Registrar code: ${r.data.registrar_code||"(none)"}`),await Oe()):alert(((t=r.data)==null?void 0:t.message)||"Lift failed")}catch(r){alert(((n=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:n.message)||"Network Error")}finally{X.value=""}},ot=async()=>{var a;try{const e=await p.get("faculty_assignment_options.php");((a=e.data)==null?void 0:a.status)==="success"&&(E.value=!!e.data.courses_enabled,F.value=e.data.courses||[],ge.value=e.data.students||[])}catch(e){console.error(e)}},nt=async()=>{var a;try{const e=await p.get("get_courses.php");((a=e.data)==null?void 0:a.status)==="success"&&(Ne.value=e.data.data||[])}catch{}},ne=async()=>{var a,e,t,d;Y.value="",z.value=!0;try{const n=await p.get("faculty_get_overview.php");((a=n.data)==null?void 0:a.status)==="success"?(we.value=!!n.data.faculty_courses_enabled,Ce.value=n.data.taught_courses||[],Se.value=n.data.advisees||[]):(z.value=!1,Y.value=((e=n.data)==null?void 0:e.message)||"Failed to load overview.")}catch(n){z.value=!1,Y.value=((d=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to load overview."}},ie=a=>{const e=String((a==null?void 0:a.first_name)||"").trim(),t=String((a==null?void 0:a.last_name)||"").trim();return`${e} ${t}`.trim()||(a==null?void 0:a.student_username)||"Student"},Ie=re(()=>{const a=Ae.value.trim().toLowerCase(),e=Array.isArray(Se.value)?[...Se.value]:[],t=n=>a?[ie(n),n==null?void 0:n.student_username,n==null?void 0:n.student_email,String((n==null?void 0:n.student_id)??""),n==null?void 0:n.entry_term_code,n==null?void 0:n.mp_status].filter(Boolean).join(" ").toLowerCase().includes(a):!0,d=n=>{const r=String((n==null?void 0:n.first_name)||"").trim(),v=String((n==null?void 0:n.student_username)||"").trim();return(r||v).charAt(0).toUpperCase()||"Z"};return e.filter(t).sort((n,r)=>{const v=d(n),g=d(r);return v!==g?v.localeCompare(g):ie(n).localeCompare(ie(r))})}),it=async()=>{var a,e,t,d;if(H.value){U.value=!0;try{const n=await p.post("faculty_add_teaching_course.php",{course_code:H.value});((a=n.data)==null?void 0:a.status)==="success"?(H.value="",await ne()):alert(((e=n.data)==null?void 0:e.message)||"Failed")}catch(n){alert(((d=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed")}finally{U.value=!1}}},dt=async a=>{var e,t,d,n;U.value=!0;try{const r=await p.post("faculty_remove_teaching_course.php",{course_code:a});((e=r.data)==null?void 0:e.status)==="success"?await ne():alert(((t=r.data)==null?void 0:t.message)||"Failed")}catch(r){alert(((n=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:n.message)||"Failed")}finally{U.value=!1}},de=async()=>{var a;fe.value=!0;try{const e=await p.get("faculty_list_assignments.php");((a=e.data)==null?void 0:a.status)==="success"&&(se.value=e.data.data||[])}catch(e){console.error(e)}finally{fe.value=!1}},ut=a=>{var e,t;ee.value=((t=(e=a==null?void 0:a.target)==null?void 0:e.files)==null?void 0:t[0])??null},rt=async()=>{var a,e,t,d;if(x.value="",R.value=!0,!m.value.title.trim()){R.value=!1,x.value="Title is required.";return}if(m.value.target_mode==="course"&&!m.value.course_code){R.value=!1,x.value="Please select a course.";return}if(m.value.target_mode==="students"&&B.value.length===0){R.value=!1,x.value="Please select at least one student.";return}te.value=!0;try{const n=new FormData;n.append("title",m.value.title),n.append("description",m.value.description||""),n.append("due_at",m.value.due_at||""),n.append("target_mode",m.value.target_mode),n.append("course_code",m.value.course_code||""),n.append("student_ids",JSON.stringify(B.value)),ee.value&&n.append("file",ee.value);const r=await p.post("faculty_create_assignment.php",n);((a=r.data)==null?void 0:a.status)==="success"?(R.value=!0,x.value="Assignment published.",m.value.title="",m.value.description="",m.value.due_at="",m.value.target_mode="all",m.value.course_code="",B.value=[],ee.value=null,await de()):(R.value=!1,x.value=((e=r.data)==null?void 0:e.message)||"Create failed.")}catch(n){R.value=!1,x.value=((d=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:d.message)||"Create failed."}finally{te.value=!1}},ct=a=>{var r,v;const e=a||[];if(e.some(g=>g.target_type==="all"))return"Target: All students";const t=(r=e.find(g=>g.target_type==="course"))==null?void 0:r.target_value;if(t)return`Target: Course ${t}`;const d=(v=e.find(g=>g.target_type==="cohort"))==null?void 0:v.target_value;return d?`Target: Cohort ${d}`:`Target: ${e.filter(g=>g.target_type==="student").length} student(s)`},We=async a=>{var e,t,d;T.value=a,I.value=[],j.value={},N.value="",W.value="",ye.value=!0;try{const n=await p.get(`faculty_get_assignment_submissions.php?assignment_id=${a.id}`);if(((e=n.data)==null?void 0:e.status)==="success"){I.value=n.data.data||[];const r={};for(const v of I.value)v.submission_id&&(r[v.submission_id]=v.grade??"");j.value=r}}catch(n){W.value=((d=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to load submissions"}finally{ye.value=!1}},vt=a=>{if(!a)return"";const e=String(a).trim();return e?e.includes("T")?e.slice(0,16):e.includes(" ")?e.replace(" ","T").slice(0,16):e:""},_t=a=>{var v,g;C.value="",S.value=!0;const e=a.targets||[];let t="all",d="",n="",r=[];e.some(k=>k.target_type==="all")?t="all":e.some(k=>k.target_type==="course")?(t="course",d=((v=e.find(k=>k.target_type==="course"))==null?void 0:v.target_value)||""):e.some(k=>k.target_type==="cohort")?(t="cohort",n=((g=e.find(k=>k.target_type==="cohort"))==null?void 0:g.target_value)||""):(t="students",r=e.filter(k=>k.target_type==="student").map(k=>String(k.target_value||"")).filter(Boolean)),c.value={assignment_id:a.id,title:a.title||"",description:a.description||"",due_at:vt(a.due_at),target_mode:t,course_code:d,cohort_term_code:n,student_ids:r},he.value=!0},Ge=()=>{he.value=!1,c.value=null,C.value="",S.value=!0},mt=async()=>{var e,t,d,n,r;if(!c.value)return;if(C.value="",S.value=!0,!(c.value.title||"").trim()){S.value=!1,C.value="Title is required.";return}if(c.value.target_mode==="course"&&!c.value.course_code){S.value=!1,C.value="Please select a course.";return}if(c.value.target_mode==="cohort"&&!c.value.cohort_term_code){S.value=!1,C.value="Missing cohort term code (legacy). Please switch target to Course or Students.";return}if(c.value.target_mode==="students"&&(!c.value.student_ids||c.value.student_ids.length===0)){S.value=!1,C.value="Please select at least one student.";return}G.value=!0;try{const v=await p.post("faculty_update_assignment.php",{assignment_id:c.value.assignment_id,title:c.value.title,description:c.value.description,due_at:c.value.due_at||"",target_mode:c.value.target_mode,course_code:c.value.course_code||"",cohort_term_code:c.value.cohort_term_code||"",student_ids:c.value.student_ids||[]});((e=v.data)==null?void 0:e.status)==="success"?(S.value=!0,C.value=((t=v.data)==null?void 0:t.message)||"Saved.",await de(),T.value&&T.value.id===c.value.assignment_id&&(T.value=se.value.find(g=>g.id===c.value.assignment_id)||T.value),Ge()):(S.value=!1,C.value=((d=v.data)==null?void 0:d.message)||"Save failed.")}catch(v){S.value=!1,C.value=((r=(n=v==null?void 0:v.response)==null?void 0:n.data)==null?void 0:r.message)||"Save failed."}finally{G.value=!1}},pt=async a=>{var e,t,d,n,r;if(confirm(`Delete assignment "${a.title}" (#${a.id})? This will also delete submissions.`))try{const v=await p.post("faculty_delete_assignment.php",{assignment_id:a.id});((e=v.data)==null?void 0:e.status)==="success"?(await de(),((t=T.value)==null?void 0:t.id)===a.id&&(T.value=null,I.value=[],W.value="")):alert(((d=v.data)==null?void 0:d.message)||"Delete failed")}catch(v){alert(((r=(n=v==null?void 0:v.response)==null?void 0:n.data)==null?void 0:r.message)||"Delete failed")}},Je=(a,e)=>{j.value={...j.value,[a]:e}},Ye=async a=>{var e,t,d,n,r,v;if(a!=null&&a.submission_id){O.value=String(a.submission_id),N.value="",q.value=!0;try{const g=(e=j.value)==null?void 0:e[a.submission_id],k={submission_id:a.submission_id,grade:g===""?null:g},Z=await p.post("faculty_grade_assignment_submission.php",k);((t=Z.data)==null?void 0:t.status)==="success"?(N.value=((d=Z.data)==null?void 0:d.message)||"Saved.",q.value=!0,a.grade=Z.data.grade,a.graded_at=Z.data.graded_at??null):(N.value=((n=Z.data)==null?void 0:n.message)||"Save failed.",q.value=!1)}catch(g){N.value=((v=(r=g==null?void 0:g.response)==null?void 0:r.data)==null?void 0:v.message)||"Save failed.",q.value=!1}finally{O.value=""}}},gt=async a=>{a!=null&&a.submission_id&&(Je(a.submission_id,""),await Ye(a))},ft=async a=>{try{const e=await p.get(`download_assignment_file.php?assignment_id=${a.id}`,{responseType:"blob"});Ve(e.data)}catch{alert("Download failed")}},yt=async a=>{if(a.submission_id)try{const e=await p.get(`download_assignment_submission.php?submission_id=${a.submission_id}`,{responseType:"blob"});Ve(e.data)}catch{alert("Download failed")}},ze=async a=>{var e;D.value=a,be.value=!0,P.value="",J.value=[],ke.value=!0;try{const t=await p.get(`assignment_submission_comments_list.php?submission_id=${a.submission_id}`);((e=t.data)==null?void 0:e.status)==="success"&&(J.value=t.data.data||[])}finally{ke.value=!1}},ht=()=>{be.value=!1,D.value=null,J.value=[],P.value=""},bt=async()=>{var a,e,t,d,n;if((a=D.value)!=null&&a.submission_id){ae.value=!0;try{const r=await p.post("faculty_add_submission_comment.php",{submission_id:D.value.submission_id,comment:P.value});((e=r.data)==null?void 0:e.status)==="success"?(P.value="",await ze(D.value),await We(T.value)):alert(((t=r.data)==null?void 0:t.message)||"Failed to post comment")}catch(r){alert(((n=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:n.message)||"Failed to post comment")}finally{ae.value=!1}}},ue=a=>`${a.first_name||""} ${a.last_name||""}`.trim()||a.student_username||"Student",Qe=async(a,e)=>{if(confirm(`Are you sure you want to ${e.toUpperCase()} ${ue(a)}?`))try{const t=await p.post("faculty_respond_mp.php",{student_id:a.student_id,action:e});t.data.status==="success"?(alert("Success: "+t.data.message),Ee()):alert(t.data.message||"Failed")}catch{alert("Network Error")}},Fe=async a=>{var e,t;L.value=a,Re.value=!0,V.value="",Q.value=[],Ue.value=!0;try{const d=await p.get(`document_comments_list.php?doc_id=${a.doc_id}`);d.data.status==="success"?Q.value=d.data.data||[]:alert(d.data.message||"Failed to load comments")}catch(d){alert(((t=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to load comments")}finally{Ue.value=!1}},kt=()=>{Re.value=!1,L.value=null,Q.value=[],V.value=""},wt=async()=>{var a,e;if(L.value){oe.value=!0;try{const t=await p.post("document_comments_add.php",{doc_id:L.value.doc_id,comment:V.value});t.data.status==="success"?(V.value="",await Fe(L.value)):alert(t.data.message||"Failed to post comment")}catch(t){alert(((e=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to post comment")}finally{oe.value=!1}}},Ct=async()=>{try{await p.post("logout.php")}catch{}localStorage.removeItem("user"),ce.push("/")};return(a,e)=>(o(),l("div",Dt,[s("header",Lt,[e[25]||(e[25]=s("div",{class:"brand"},"Grad System (Faculty Portal)",-1)),s("div",xt,[K.value.username?(o(),l("span",Rt,"Prof. "+i(K.value.username),1)):_("",!0),s("button",{onClick:Ct,class:"btn-logout"},"Logout")])]),s("div",Ut,[s("aside",Mt,[s("nav",null,[s("ul",null,[s("li",{class:A({active:y.value==="research"}),onClick:e[0]||(e[0]=t=>y.value="research")},"Research Hold",2),s("li",{class:A({active:y.value==="overview"}),onClick:e[1]||(e[1]=t=>y.value="overview")},"My Teaching",2),s("li",{class:A({active:y.value==="assignments"}),onClick:e[2]||(e[2]=t=>y.value="assignments")},"Assignments",2),s("li",{class:A({active:y.value==="docs"}),onClick:e[3]||(e[3]=t=>y.value="docs")},"Advisee Docs",2),s("li",{class:A({active:y.value==="thesis"}),onClick:e[4]||(e[4]=t=>y.value="thesis")},"Thesis / Project",2),s("li",{class:A({active:y.value==="mp"}),onClick:e[5]||(e[5]=t=>y.value="mp")},"MP Requests",2)])])]),s("main",Ft,[y.value==="research"?(o(),l("div",Nt,[e[27]||(e[27]=s("h2",null,"Research Method Hold Check (Term 3)",-1)),e[28]||(e[28]=s("p",{class:"subtitle"},[w(" You can lift the "),s("strong",null,"research_method"),w(" hold only after the student has registered/taken the Research Method course. ")],-1)),me.value?(o(),l("div",Pt,"Loading...")):pe.value.length===0?(o(),l("div",Vt,"No active research_method holds for your advisees.")):(o(),l("div",Et,[(o(!0),l(h,null,b(pe.value,t=>(o(),l("div",{key:`${t.student_id}-${t.term_code||""}`,class:"review-item"},[s("div",jt,[s("span",Ot,i(t.student_username||`#${t.student_id}`)+" (#"+i(t.student_id)+")",1),s("span",qt,[w(" Hold: research_method · Term: "+i(t.term_code||"-")+" · Research Method: ",1),s("strong",null,i(Number(t.has_research_method)?"YES":"NO"),1)]),t.proof_doc_id?(o(),l("span",Ht,[e[26]||(e[26]=w(" Proof uploaded: ",-1)),s("strong",null,i(String(t.proof_status||"pending")),1),t.proof_upload_date?(o(),l("span",Bt," · "+i(t.proof_upload_date),1)):_("",!0)])):_("",!0)]),s("div",It,[t.proof_doc_id?(o(),l("a",{key:0,href:Me({doc_id:t.proof_doc_id}),target:"_blank",class:"btn-view"},"View Proof",8,Wt)):_("",!0),s("button",{class:"btn-approve",onClick:d=>lt(t),disabled:!Number(t.has_research_method)||X.value===String(t.student_id)},i(X.value===String(t.student_id)?"Working...":"Lift Hold"),9,Gt)])]))),128))]))])):y.value==="overview"?(o(),l("div",Jt,[s("div",Yt,[e[32]||(e[32]=s("h2",null,"My Teaching Courses",-1)),we.value?Y.value?(o(),l("div",{key:1,class:A(["msg",{ok:z.value,bad:!z.value}])},i(Y.value),3)):_("",!0):(o(),l("div",zt,[...e[29]||(e[29]=[w(" Teaching courses table not found. Run ",-1),s("code",null,"backend/sql/10_faculty_courses.sql",-1),w(" in MySQL. ",-1)])])),s("div",Qt,[f(s("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>H.value=t),class:"select"},[e[30]||(e[30]=s("option",{disabled:"",value:""},"-- Select a course to add --",-1)),(o(!0),l(h,null,b(Ne.value,t=>(o(),l("option",{key:t.course_code,value:t.course_code},i(t.course_code)+" · "+i(t.course_name)+" ("+i(t.credits)+") ",9,Zt))),128))],512),[[M,H.value]]),s("button",{class:"btn-approve",onClick:it,disabled:!H.value||!we.value||U.value},i(U.value?"Working...":"Add"),9,Kt)]),Ce.value.length===0?(o(),l("div",Xt,"No courses added.")):(o(),l("div",es,[e[31]||(e[31]=s("div",{class:"row header"},[s("div",null,"Course"),s("div",null,"Name"),s("div",null,"Credits"),s("div")],-1)),(o(!0),l(h,null,b(Ce.value,t=>(o(),l("div",{key:t.course_code,class:"row"},[s("div",null,[s("strong",null,i(t.course_code),1)]),s("div",null,i(t.course_name||"-"),1),s("div",null,i(t.credits||"-"),1),s("div",ts,[s("button",{class:"btn-reject",onClick:d=>dt(t.course_code),disabled:U.value},"Remove",8,ss)])]))),128))]))]),s("div",as,[e[34]||(e[34]=s("h2",null,"My Advisees",-1)),s("div",ls,[f(s("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>Ae.value=t),class:"select",type:"text",placeholder:"Search by name / username / email / id..."},null,512),[[$,Ae.value]]),s("button",{class:"btn-view",onClick:ne,disabled:U.value},"Refresh",8,os)]),Ie.value.length===0?(o(),l("div",ns,"No advisees found.")):(o(),l("div",is,[e[33]||(e[33]=s("div",{class:"row header"},[s("div",null,"Student"),s("div",null,"Email"),s("div",null,"Cohort"),s("div",null,"Status")],-1)),(o(!0),l(h,null,b(Ie.value,t=>(o(),l("div",{key:t.student_id,class:"row"},[s("div",null,[s("strong",null,i(ie(t)),1),s("span",ds," (#"+i(t.student_id)+")",1)]),s("div",null,i(t.student_email||"-"),1),s("div",null,i(t.entry_term_code||"-"),1),s("div",null,i(t.mp_status),1)]))),128))]))])])):y.value==="assignments"?(o(),l("div",us,[s("div",rs,[e[47]||(e[47]=s("h2",null,"Create Assignment",-1)),s("div",cs,[s("div",vs,[e[35]||(e[35]=s("label",null,"Title",-1)),f(s("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>m.value.title=t),type:"text",placeholder:"e.g. HW1: Reading Summary"},null,512),[[$,m.value.title]])]),s("div",_s,[e[36]||(e[36]=s("label",null,"Due (optional)",-1)),f(s("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>m.value.due_at=t),type:"datetime-local"},null,512),[[$,m.value.due_at]])]),s("div",ms,[e[37]||(e[37]=s("label",null,"Description (optional)",-1)),f(s("textarea",{"onUpdate:modelValue":e[10]||(e[10]=t=>m.value.description=t),rows:"4",placeholder:"Details..."},null,512),[[$,m.value.description]])]),s("div",ps,[e[40]||(e[40]=s("label",null,"Target",-1)),f(s("select",{"onUpdate:modelValue":e[11]||(e[11]=t=>m.value.target_mode=t)},[e[38]||(e[38]=s("option",{value:"all"},"All Students",-1)),s("option",{value:"course",disabled:!E.value||F.value.length===0},"Course",8,gs),e[39]||(e[39]=s("option",{value:"students"},"Selected Students",-1))],512),[[M,m.value.target_mode]])]),m.value.target_mode==="course"?(o(),l("div",fs,[e[43]||(e[43]=s("label",null,"Course",-1)),E.value?_("",!0):(o(),l("div",ys,[...e[41]||(e[41]=[w(" Teaching courses table not found. Add courses in ",-1),s("strong",null,"My Teaching",-1),w(" first. ",-1)])])),f(s("select",{"onUpdate:modelValue":e[12]||(e[12]=t=>m.value.course_code=t),disabled:!E.value||F.value.length===0},[e[42]||(e[42]=s("option",{disabled:"",value:""},"-- Select Course --",-1)),(o(!0),l(h,null,b(F.value,t=>(o(),l("option",{key:t.course_code,value:t.course_code},i(t.course_code)+i(t.course_name?` · ${t.course_name}`:""),9,bs))),128))],8,hs),[[M,m.value.course_code]])])):_("",!0),m.value.target_mode==="students"?(o(),l("div",ks,[e[44]||(e[44]=s("label",null,"Students",-1)),f(s("select",{"onUpdate:modelValue":e[13]||(e[13]=t=>B.value=t),multiple:"",class:"multi"},[(o(!0),l(h,null,b(ge.value,t=>(o(),l("option",{key:t.student_id,value:String(t.student_id)},i(t.username)+" (#"+i(t.student_id)+") "+i(t.entry_term_code?`· ${t.entry_term_code}`:""),9,ws))),128))],512),[[M,B.value]]),e[45]||(e[45]=s("div",{class:"hint"},"Hold Ctrl/Cmd to select multiple.",-1))])):_("",!0),s("div",Cs,[e[46]||(e[46]=s("label",null,"Attachment (optional)",-1)),s("input",{type:"file",onChange:ut},null,32)])]),s("div",Ss,[s("button",{class:"btn-approve",onClick:rt,disabled:te.value},i(te.value?"Creating...":"Publish Assignment"),9,As)]),x.value?(o(),l("div",{key:0,class:A(["msg",{ok:R.value,bad:!R.value}])},i(x.value),3)):_("",!0)]),s("div",$s,[e[49]||(e[49]=s("h2",null,"My Assignments",-1)),fe.value?(o(),l("div",Ts,"Loading...")):se.value.length===0?(o(),l("div",Ds,"No assignments yet.")):(o(),l("div",Ls,[(o(!0),l(h,null,b(se.value,t=>(o(),l("div",{key:t.id,class:"review-item"},[s("div",xs,[s("span",Rs,i(t.title)+" (#"+i(t.id)+")",1),s("span",Us,[w(" Created: "+i(t.created_at)+" ",1),t.due_at?(o(),l("span",Ms,"· Due: "+i(t.due_at),1)):_("",!0),e[48]||(e[48]=w(" · Submissions: ",-1)),s("strong",null,i(t.submissions_count),1)]),s("span",Fs,i(ct(t.targets)),1)]),s("div",Ns,[s("button",{class:"btn-view",onClick:d=>We(t)},"View",8,Ps),t.attachment_path?(o(),l("button",{key:0,class:"btn-view",onClick:d=>ft(t)},"Attachment",8,Vs)):_("",!0),s("button",{class:"btn-view",onClick:d=>_t(t)},"Edit",8,Es),s("button",{class:"btn-reject",onClick:d=>pt(t)},"Delete",8,js)])]))),128))]))]),T.value?(o(),l("div",Os,[s("h2",null,"Submissions · "+i(T.value.title),1),W.value?(o(),l("div",qs,i(W.value),1)):_("",!0),ye.value?(o(),l("div",Hs,"Loading submissions...")):(o(),l("div",Bs,[(o(!0),l(h,null,b(I.value,t=>(o(),l("div",{key:t.student_id,class:"review-item"},[s("div",Is,[s("span",Ws,i(ue(t))+" (#"+i(t.student_id)+")",1),s("span",Gs,[w(i(t.submission_id?`Submitted: ${t.submitted_at}`:"Not submitted yet.")+" ",1),t.entry_term_code?(o(),l("span",Js,"· Cohort: "+i(t.entry_term_code),1)):_("",!0)]),t.submission_id?(o(),l("span",Ys,[e[50]||(e[50]=w(" Grade: ",-1)),t.grade!==null&&t.grade!==void 0?(o(),l("strong",zs,i(t.grade),1)):(o(),l("span",Qs,"-")),t.graded_at?(o(),l("span",Zs," · graded_at: "+i(t.graded_at),1)):_("",!0)])):_("",!0)]),s("div",Ks,[t.submission_id?(o(),l("button",{key:0,class:"btn-view",onClick:d=>yt(t)},"Download",8,Xs)):_("",!0),t.submission_id?(o(),l("button",{key:1,class:"btn-view",onClick:d=>ze(t)}," Comments ("+i(Number(t.comments_count||0))+") ",9,ea)):_("",!0),t.submission_id?(o(),l("div",ta,[s("input",{class:"grade-input",type:"number",min:"0",max:"100",step:"0.01",value:j.value[t.submission_id]??"",placeholder:"0-100",onInput:d=>{var n;return Je(t.submission_id,(n=d==null?void 0:d.target)==null?void 0:n.value)},disabled:O.value===String(t.submission_id)},null,40,sa),s("button",{class:"btn-approve",onClick:d=>Ye(t),disabled:O.value===String(t.submission_id)},i(O.value===String(t.submission_id)?"Saving...":"Save"),9,aa),s("button",{class:"btn-reject",onClick:d=>gt(t),disabled:O.value===String(t.submission_id)}," Clear ",8,la)])):_("",!0)])]))),128))])),N.value?(o(),l("div",{key:3,class:A(["msg",{ok:q.value,bad:!q.value}])},i(N.value),3)):_("",!0)])):_("",!0)])):y.value==="docs"?(o(),l("div",oa,[e[52]||(e[52]=s("h2",null,"My Advisee Documents",-1)),e[53]||(e[53]=s("p",{class:"subtitle"},"Documents submitted by students who selected you as their Major Professor.",-1)),s("div",na,[f(s("input",{"onUpdate:modelValue":e[14]||(e[14]=t=>Le.value=t),class:"select",type:"text",placeholder:"Search by name / username / email / id..."},null,512),[[$,Le.value]]),f(s("select",{"onUpdate:modelValue":e[15]||(e[15]=t=>xe.value=t),class:"select",style:{"min-width":"220px"}},[e[51]||(e[51]=s("option",{value:""},"All terms",-1)),(o(!0),l(h,null,b(st.value,t=>(o(),l("option",{key:t,value:t},i(t),9,ia))),128))],512),[[M,xe.value]]),s("button",{class:"btn-view",onClick:je,disabled:U.value},"Refresh",8,da)]),Be.value.length===0?(o(),l("div",ua,"No advisee documents.")):(o(),l("div",ra,[(o(!0),l(h,null,b(Be.value,t=>(o(),l("div",{key:t.doc_id,class:"review-item"},[s("div",ca,[s("span",va,[w(i(ue(t))+" (#"+i(t.student_id)+") ",1),t.entry_term_code?(o(),l("span",_a,"· "+i(t.entry_term_code),1)):_("",!0)]),s("div",ma,[s("span",pa,i(Ze(t.doc_type)),1),s("span",ga,i(Ke(t.file_path)),1),s("span",{class:A(["doc-status-pill",et(t.status)])},i(Xe(t.status)),3),t.upload_date?(o(),l("span",fa,"· "+i(t.upload_date),1)):_("",!0)])]),s("div",ya,[s("a",{href:Me(t),target:"_blank",class:"btn-view"},"View",8,ha),s("button",{class:"btn-view",onClick:d=>Fe(t)},"Comments",8,ba)])]))),128))]))])):y.value==="thesis"?(o(),l("div",ka,[s("div",wa,[e[55]||(e[55]=s("h2",null,"Defense Window (Admin-published)",-1)),$e.value?(o(),l("div",Ca,"Loading...")):Te.value.length===0?(o(),l("div",Sa,"No defense windows published yet.")):(o(),l("div",Aa,[e[54]||(e[54]=s("div",{class:"row header defense-row"},[s("div",null,"Year"),s("div",null,"Start"),s("div",null,"End")],-1)),(o(!0),l(h,null,b(Te.value,t=>(o(),l("div",{key:t.year,class:"row defense-row"},[s("div",null,[s("strong",null,i(t.year),1)]),s("div",null,i(t.start_date),1),s("div",null,i(t.end_date),1)]))),128))]))]),s("div",$a,[e[57]||(e[57]=s("h2",null,"Advisee Thesis / Project Timeline",-1)),s("div",Ta,[f(s("input",{"onUpdate:modelValue":e[16]||(e[16]=t=>De.value=t),class:"select",type:"text",placeholder:"Search advisees..."},null,512),[[$,De.value]]),s("button",{class:"btn-view",onClick:qe,disabled:le.value},"Refresh",8,Da)]),le.value?(o(),l("div",La,"Loading...")):He.value.length===0?(o(),l("div",xa,"No data.")):(o(),l("div",Ra,[e[56]||(e[56]=s("div",{class:"row header thesis-row"},[s("div",null,"Student"),s("div",null,"Type"),s("div",null,"Submission"),s("div",null,"Defense"),s("div",null,"File"),s("div",null,"Title")],-1)),(o(!0),l(h,null,b(He.value,t=>(o(),l("div",{key:t.student_id,class:"row thesis-row"},[s("div",null,[s("strong",null,i(t.student_username||`#${t.student_id}`),1),s("span",Ua," (#"+i(t.student_id)+")",1)]),s("div",null,i(t.type||"-"),1),s("div",null,i(t.submission_date||"-"),1),s("div",null,i(t.defense_date||"-"),1),s("div",null,[t.thesis_doc_id?(o(),l("div",Ma,[s("a",{href:Me({doc_id:t.thesis_doc_id}),target:"_blank",class:"btn-view"},"View",8,Fa),s("button",{class:"btn-view",onClick:d=>at(t)},"Comments",8,Na)])):(o(),l("span",Pa,"-"))]),s("div",null,i(t.title||"-"),1)]))),128))]))])])):(o(),l("div",Va,[e[58]||(e[58]=s("h2",null,"Major Professor Requests",-1)),e[59]||(e[59]=s("p",{class:"subtitle"},"Students requesting you as their advisor.",-1)),ve.value.length===0?(o(),l("div",Ea,"No new advising requests.")):(o(),l("div",ja,[(o(!0),l(h,null,b(ve.value,t=>(o(),l("div",{key:t.student_id,class:"review-item highlight-item"},[s("div",Oa,[s("span",qa,i(ue(t))+" (#"+i(t.student_id)+")",1),s("span",Ha,i(t.email),1)]),s("div",Ba,[s("button",{onClick:d=>Qe(t,"reject"),class:"btn-reject"},"Decline",8,Ia),s("button",{onClick:d=>Qe(t,"accept"),class:"btn-approve"},"Accept Student",8,Wa)])]))),128))]))]))])]),Re.value?(o(),l("div",Ga,[s("div",Ja,[e[60]||(e[60]=s("h3",null,"Document Comments",-1)),L.value?(o(),l("div",Ya,[s("div",null,[s("strong",null,i(L.value.student_username||`#${L.value.student_id}`),1),s("span",null," · "+i(L.value.doc_type)+" · doc_id="+i(L.value.doc_id),1)])])):_("",!0),s("div",za,[Ue.value?(o(),l("div",Qa,"Loading comments...")):Q.value.length===0?(o(),l("div",Za,"No comments yet.")):(o(),l("div",Ka,[(o(!0),l(h,null,b(Q.value,t=>(o(),l("div",{key:t.id,class:"comment-item"},[s("div",Xa,[s("span",el,i(t.author_username||t.author_role),1),s("span",tl,i(t.created_at),1)]),s("div",sl,i(t.comment),1)]))),128))]))]),f(s("textarea",{"onUpdate:modelValue":e[17]||(e[17]=t=>V.value=t),placeholder:"Write a comment...",rows:"4"},null,512),[[$,V.value]]),s("div",al,[s("button",{onClick:kt,class:"btn-cancel"},"Close"),s("button",{onClick:wt,class:"btn-confirm-approve",disabled:oe.value||!V.value.trim()},i(oe.value?"Posting...":"Post Comment"),9,ll)])])])):_("",!0),be.value?(o(),l("div",ol,[s("div",nl,[e[61]||(e[61]=s("h3",null,"Submission Comments",-1)),D.value?(o(),l("div",il,[s("div",null,[s("strong",null,i(D.value.student_username||`#${D.value.student_id}`),1),s("span",null," · submission_id="+i(D.value.submission_id),1)])])):_("",!0),s("div",dl,[ke.value?(o(),l("div",ul,"Loading comments...")):J.value.length===0?(o(),l("div",rl,"No comments yet.")):(o(),l("div",cl,[(o(!0),l(h,null,b(J.value,t=>(o(),l("div",{key:t.id,class:"comment-item"},[s("div",vl,[s("span",_l,i(t.author_username||t.author_role),1),s("span",ml,i(t.created_at),1)]),s("div",pl,i(t.comment),1)]))),128))]))]),f(s("textarea",{"onUpdate:modelValue":e[18]||(e[18]=t=>P.value=t),placeholder:"Write a comment...",rows:"4"},null,512),[[$,P.value]]),s("div",gl,[s("button",{onClick:ht,class:"btn-cancel"},"Close"),s("button",{onClick:bt,class:"btn-confirm-approve",disabled:ae.value||!P.value.trim()||!D.value},i(ae.value?"Posting...":"Post Comment"),9,fl)])])])):_("",!0),he.value?(o(),l("div",yl,[s("div",hl,[e[74]||(e[74]=s("h3",null,"Edit Assignment",-1)),C.value?(o(),l("div",{key:0,class:A(["msg",{ok:S.value,bad:!S.value}])},i(C.value),3)):_("",!0),c.value?(o(),l("div",bl,[s("div",kl,[e[62]||(e[62]=s("label",null,"Title",-1)),f(s("input",{"onUpdate:modelValue":e[19]||(e[19]=t=>c.value.title=t),type:"text"},null,512),[[$,c.value.title]])]),s("div",wl,[e[63]||(e[63]=s("label",null,"Description",-1)),f(s("textarea",{"onUpdate:modelValue":e[20]||(e[20]=t=>c.value.description=t),rows:"4"},null,512),[[$,c.value.description]])]),s("div",Cl,[e[64]||(e[64]=s("label",null,"Due At",-1)),f(s("input",{"onUpdate:modelValue":e[21]||(e[21]=t=>c.value.due_at=t),type:"datetime-local"},null,512),[[$,c.value.due_at]])]),s("div",Sl,[e[68]||(e[68]=s("label",null,"Target",-1)),f(s("select",{"onUpdate:modelValue":e[22]||(e[22]=t=>c.value.target_mode=t)},[e[65]||(e[65]=s("option",{value:"all"},"All Students",-1)),s("option",{value:"course",disabled:!E.value||F.value.length===0},"Course",8,Al),e[66]||(e[66]=s("option",{value:"cohort",disabled:""},"Cohort (Legacy)",-1)),e[67]||(e[67]=s("option",{value:"students"},"Specific Students",-1))],512),[[M,c.value.target_mode]])]),c.value.target_mode==="cohort"?(o(),l("div",$l,[e[69]||(e[69]=s("label",null,"Cohort Term Code (legacy)",-1)),s("input",{value:c.value.cohort_term_code||"",type:"text",disabled:""},null,8,Tl)])):_("",!0),c.value.target_mode==="course"?(o(),l("div",Dl,[e[71]||(e[71]=s("label",null,"Course",-1)),f(s("select",{"onUpdate:modelValue":e[23]||(e[23]=t=>c.value.course_code=t),class:"select",disabled:!E.value||F.value.length===0},[e[70]||(e[70]=s("option",{disabled:"",value:""},"-- Select course --",-1)),(o(!0),l(h,null,b(F.value,t=>(o(),l("option",{key:t.course_code,value:t.course_code},i(t.course_code)+i(t.course_name?` · ${t.course_name}`:""),9,xl))),128))],8,Ll),[[M,c.value.course_code]])])):_("",!0),c.value.target_mode==="students"?(o(),l("div",Rl,[e[72]||(e[72]=s("label",null,"Students",-1)),f(s("select",{"onUpdate:modelValue":e[24]||(e[24]=t=>c.value.student_ids=t),multiple:"",class:"multi"},[(o(!0),l(h,null,b(ge.value,t=>(o(),l("option",{key:t.student_id,value:String(t.student_id)},i(t.username)+" (#"+i(t.student_id)+") "+i(t.entry_term_code?`· ${t.entry_term_code}`:""),9,Ul))),128))],512),[[M,c.value.student_ids]]),e[73]||(e[73]=s("div",{class:"hint"},"Hold Ctrl/Cmd to select multiple.",-1))])):_("",!0)])):_("",!0),s("div",Ml,[s("button",{class:"btn-cancel",onClick:Ge,disabled:G.value},"Cancel",8,Fl),s("button",{class:"btn-confirm-approve",onClick:mt,disabled:G.value||!c.value},i(G.value?"Saving...":"Save"),9,Nl)])])])):_("",!0)]))}},jl=St(Pl,[["__scopeId","data-v-8529bfeb"]]);export{jl as default};
