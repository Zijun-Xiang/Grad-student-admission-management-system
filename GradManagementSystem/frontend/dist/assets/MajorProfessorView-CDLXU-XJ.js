import{_ as P,r as n,l as x,h as S,i as f,c as a,a as e,t as d,u as _,d as j,k as i,e as M,v as q,F,f as N,o as r}from"./index-DT2F-dT6.js";const R={class:"dashboard-layout"},V={class:"navbar"},Y={class:"user-info"},C={class:"main-container"},B={class:"content"},D={class:"card"},U={key:0,class:"status-box approved"},T={key:1,class:"status-box pending"},A={key:2,class:"form-block"},E={class:"form-section"},G=["value"],I=["disabled"],L={key:0,class:"card mt-20"},$={key:0,class:"status-box pending"},H={key:1,class:"status-box approved"},J={key:2,class:"status-box"},O={key:0,class:"text-error"},W={key:1},z={__name:"MajorProfessorView",setup(K){const c=S(),y=n({}),m=n([]),l=n(""),u=n("none"),p=n(""),b=n([]),v=n("none");x(()=>{const t=localStorage.getItem("user");t?(y.value=JSON.parse(t),k(),g()):c.push("/")});const k=async()=>{try{const t=await f.get("get_faculty_list.php");t.data.status==="success"&&(m.value=t.data.data)}catch(t){console.error(t)}},g=async()=>{try{const t=await f.get("get_status.php");if(t.data.status!=="success")return;const s=t.data.mp_info;s&&(u.value=s.mp_status,p.value=s.prof_name||"Unknown"),b.value=t.data.documents||[];const o=b.value.find(w=>w.doc_type==="major_professor_form");v.value=(o==null?void 0:o.status)||"none"}catch(t){console.error("Failed to check status",t)}},h=async()=>{if(confirm("Are you sure you want to request this professor?"))try{const t=await f.post("request_major_professor.php",{professor_id:l.value});if(t.data.status==="success"){alert("Request Sent!"),u.value="pending";const s=m.value.find(o=>o.user_id===l.value);p.value=s?s.username:"Unknown"}else alert(t.data.message||"Request failed")}catch{alert("Network Error")}};return(t,s)=>(r(),a("div",R,[e("header",V,[s[3]||(s[3]=e("div",{class:"brand"},"Grad System",-1)),e("div",Y,[e("span",null,"Welcome, "+d(y.value.username),1),e("button",{onClick:s[0]||(s[0]=o=>_(c).push("/dashboard")),class:"btn-back"},"Back to Dashboard")])]),e("div",C,[e("main",B,[e("div",D,[s[13]||(s[13]=e("h2",null,"Select Major Professor",-1)),u.value==="approved"?(r(),a("div",U,[s[5]||(s[5]=e("h3",null,"You have a Major Professor",-1)),e("p",null,[s[4]||(s[4]=i("Your advisor is: ",-1)),e("strong",null,d(p.value),1)])])):u.value==="pending"?(r(),a("div",T,[s[8]||(s[8]=e("h3",null,"Request Pending",-1)),e("p",null,[s[6]||(s[6]=i("You have requested ",-1)),e("strong",null,d(p.value),1),s[7]||(s[7]=i(" as your advisor.",-1))]),s[9]||(s[9]=e("p",null,"Please wait for their approval.",-1))])):(r(),a("div",A,[s[12]||(s[12]=e("div",{class:"alert-box"},'You have a "Major Professor" Hold. Please select an advisor to proceed.',-1)),e("div",E,[s[11]||(s[11]=e("label",null,"Choose a Faculty Member:",-1)),M(e("select",{"onUpdate:modelValue":s[1]||(s[1]=o=>l.value=o),class:"prof-select"},[s[10]||(s[10]=e("option",{disabled:"",value:""},"-- Select Professor --",-1)),(r(!0),a(F,null,N(m.value,o=>(r(),a("option",{key:o.user_id,value:o.user_id},d(o.username)+" ("+d(o.email)+") ",9,G))),128))],512),[[q,l.value]]),e("button",{onClick:h,class:"btn-primary",disabled:!l.value},"Submit Request",8,I)])]))]),u.value==="approved"?(r(),a("div",L,[s[16]||(s[16]=e("h2",null,"Major Professor Form (Term 2)",-1)),s[17]||(s[17]=e("p",{class:"text-muted"},[i(" All document uploads are handled in "),e("strong",null,"Documents"),i(". This page only manages advisor selection. ")],-1)),v.value==="pending"?(r(),a("div",$,[...s[14]||(s[14]=[e("p",null,"Your form is under review.",-1)])])):v.value==="approved"?(r(),a("div",H,[...s[15]||(s[15]=[e("p",null,"Your form has been approved.",-1)])])):(r(),a("div",J,[v.value==="rejected"?(r(),a("p",O,"Previous upload was rejected. Please re-upload.")):(r(),a("p",W,"No form uploaded yet.")),e("button",{class:"btn-primary",onClick:s[2]||(s[2]=o=>_(c).push("/documents"))},"Go to Documents")]))])):j("",!0)])])]))}},X=P(z,[["__scopeId","data-v-25a1753b"]]);export{X as default};
