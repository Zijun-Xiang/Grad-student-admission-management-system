import{_ as O,r as a,w as k,c as v,a as t,b as _,d as T,e as r,v as x,F as B,f as q,g as n,t as D,u as A,h as I,o as p,i as L}from"./index-Dl1toHCS.js";const j={class:"login-container"},G={class:"login-card"},H={class:"form-group"},J={class:"form-row"},z={class:"form-group"},K=["value"],Q={class:"form-group"},W={key:0,class:"form-row"},X={class:"form-group"},Z={class:"form-group"},h={class:"form-group"},ee={class:"form-group"},te={class:"form-group"},se={class:"form-group"},le={class:"form-group"},ae={key:1,class:"error-msg"},oe={key:2,class:"success-msg"},re=["disabled"],ne={__name:"RegisterView",setup(ue){const Y=I(),y=a("student"),V=a(""),S=a(""),i=a(""),o=a(""),m=a(new Date().getFullYear()),U=a([]),F=a(""),R=a(""),c=a(""),N=a(""),d=a(""),w=a(""),b=a(!1),C=l=>{const e=new Date(l+"T00:00:00");if(isNaN(e.getTime()))return"";const s=e.getFullYear(),f=e.getMonth()+1;return f<=4?`${s}SP`:f<=8?`${s}SU`:`${s}FA`};(()=>{const l=new Date().getFullYear();U.value=[];for(let e=l-5;e<=l+5;e++)U.value.push(e)})();const M=()=>new Date().toISOString().slice(0,10);o.value=M(),i.value=C(o.value);const P=()=>{if(!o.value)return;const l=o.value.split("-");l.length===3&&(o.value=`${m.value}-${l[1]}-${l[2]}`,i.value=C(o.value))},$=()=>{if(!o.value)return;const l=new Date(o.value+"T00:00:00");isNaN(l.getTime())||(m.value=l.getFullYear(),i.value=C(o.value))};k(m,P),k(o,$);const E=async()=>{var l,e,s,f;if(d.value="",w.value="",c.value!==N.value){d.value="Passwords do not match.";return}b.value=!0;try{const g={role:y.value,username:F.value,email:R.value,password:c.value,first_name:V.value,last_name:S.value,term_code:i.value,entry_date:o.value},u=await L.post("register.php",g);((l=u.data)==null?void 0:l.status)==="success"?(localStorage.setItem("user",JSON.stringify(u.data.user)),w.value="Registration successful. Redirecting...",setTimeout(()=>{Y.push(u.data.user.role==="faculty"?"/faculty":u.data.user.role==="admin"?"/admin":"/dashboard")},1500)):d.value=((e=u.data)==null?void 0:e.message)||"Registration failed."}catch(g){const u=(f=(s=g==null?void 0:g.response)==null?void 0:s.data)==null?void 0:f.message;d.value=u||"Registration failed (network/CORS/DB)."}finally{b.value=!1}};return(l,e)=>(p(),v("div",j,[t("div",G,[e[23]||(e[23]=t("div",{class:"login-header"},[t("h1",null,"Create Account"),t("p",null,"Register as Student or Faculty")],-1)),t("form",{onSubmit:_(E,["prevent"])},[t("div",H,[e[12]||(e[12]=t("label",null,"Role",-1)),r(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>y.value=s),required:""},[...e[11]||(e[11]=[t("option",{value:"student"},"Student",-1),t("option",{value:"faculty"},"Faculty (GPD/Major Professor)",-1)])],512),[[x,y.value]])]),t("div",J,[t("div",z,[e[13]||(e[13]=t("label",null,"Entry Year",-1)),r(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s)},[(p(!0),v(B,null,q(U.value,s=>(p(),v("option",{key:s,value:s},D(s),9,K))),128))],512),[[x,m.value]])]),t("div",Q,[e[14]||(e[14]=t("label",null,"Entry Date",-1)),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.value=s),type:"date"},null,512),[[n,o.value]])])]),y.value==="student"?(p(),v("div",W,[t("div",X,[e[15]||(e[15]=t("label",null,"First Name",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>V.value=s),type:"text",placeholder:"First name"},null,512),[[n,V.value]])]),t("div",Z,[e[16]||(e[16]=t("label",null,"Last Name",-1)),r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>S.value=s),type:"text",placeholder:"Last name"},null,512),[[n,S.value]])])])):T("",!0),t("div",h,[e[17]||(e[17]=t("label",null,"Entry Term Code (auto)",-1)),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>i.value=s),type:"text",disabled:""},null,512),[[n,i.value]]),e[18]||(e[18]=t("div",{class:"hint"},"Derived from Entry Date. Used to tag your first-semester Hold.",-1))]),t("div",ee,[e[19]||(e[19]=t("label",null,"Username",-1)),r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>F.value=s),type:"text",placeholder:"e.g. student1 / prof_jamil",required:""},null,512),[[n,F.value]])]),t("div",te,[e[20]||(e[20]=t("label",null,"Email",-1)),r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>R.value=s),type:"email",placeholder:"Optional"},null,512),[[n,R.value]])]),t("div",se,[e[21]||(e[21]=t("label",null,"Password",-1)),r(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>c.value=s),type:"password",placeholder:"At least 6 characters",required:""},null,512),[[n,c.value]])]),t("div",le,[e[22]||(e[22]=t("label",null,"Confirm Password",-1)),r(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>N.value=s),type:"password",placeholder:"Re-enter password",required:""},null,512),[[n,N.value]])]),d.value?(p(),v("div",ae,D(d.value),1)):T("",!0),w.value?(p(),v("div",oe,D(w.value),1)):T("",!0),t("button",{type:"submit",class:"btn-primary",disabled:b.value},D(b.value?"Creating...":"Create account"),9,re),t("button",{type:"button",class:"btn-secondary",onClick:e[10]||(e[10]=s=>A(Y).push("/"))},"Back to login")],32)])]))}},ve=O(ne,[["__scopeId","data-v-73687f0d"]]);export{ve as default};
